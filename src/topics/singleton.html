<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>Javascript IV</title>
  <link rel="stylesheet" type="text/css" href="../build/build.css">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;400;700&display=swap" rel="stylesheet">
</head>
<body>
<article class="deck">

  <section class="bg-yellow">
    <h1>Singleton</h1>
    <img style="max-width: 900px" src="/images/singleton.png" alt="">
  </section>

  <section class="bg-yellow">
    <h2 class="slide-title">The problem</h2>
    <p class="hint">The singleton pattern is useful when we need to control access to a piece of the code, ensuring that we have only one copy of it.</p>
    <p class="hint">The singleton pattern also provides us with a global access point to that instance, so that we can access it from everywhere in the application, but protecting it from being overwritten.</p>
  </section>

  <section class="bg-orange">
    <h2 class="slide-title">Singleton</h2>
    <h3 class="slide-subtitle">Class declaration</h3>
    <pre>
      <code class="language-javascript">
        let instance;
        let counter = 0;
        
        class Counter {
          constructor() {
            if (instance) {
              throw new Error("You can only create one instance!");
            }
            instance = this;
          }
        
          getInstance() {
            return this;
          }
        
          getCount() {
            return counter;
          }
        
          increment() {
            return ++counter;
          }
        
          decrement() {
            return --counter;
          }
        }
        
        const singletonCounter = Object.freeze(new Counter());
        export default singletonCounter;
      </code>
    </pre>
  </section>

  <section class="bg-orange">
    <h2 class="slide-title">Singleton</h2>
    <h3 class="slide-subtitle">Class declaration</h3>
    <pre>
      <code class="language-javascript">
        // This is a regular class
        class State {
          constructor() {
            this.orders = [];
            this.user = {};
          }

          addOrder(order) {
            this.orders.push(order)
          }
        }

        // This is the singleton
        class Singleton {
          constructor() {
            if (!Singleton.instance) {
              Singleton.instance = new State();
            }
          }

          getInstance() {
            return Singleton.instance
          }
        }

        export default Singleton;
      </code>
    </pre>
  </section>

  <section class="bg-orange">
    <h2 class="slide-title">Singleton</h2>
    <h3 class="slide-subtitle">Usage</h3>
    <pre>
      <code class="language-javascript">
        // In some place of the app
        const state = new Singleton().getInstance();

        const renderOrders = (orders) => {
          console.log('Do something with the orders', orders);
        };

        renderOrders(state.orders);

        // In another place of the app
        const anotherStateVar = new Singleton().getInstance();

        const handleOrder = (event) => {
          state.addOrder(event.target.value);
        };
      </code>
    </pre>
  </section>

<script src="../build/build.js"></script>

</body>
</html>
